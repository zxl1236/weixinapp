<view class="container">
  <!-- ä¼šå‘˜çŠ¶æ€å¡ç‰‡ -->
  <view class="membership-card {{membershipStatus.isPremium ? 'premium' : 'free'}}">
    <view class="membership-header">
      <view class="membership-icon">{{membershipStatus.isPremium ? 'ğŸ‘‘' : 'ğŸ“š'}}</view>
      <view class="membership-info">
        <view class="membership-title">
          {{membershipStatus.isPremium ? 'é«˜çº§ä¼šå‘˜' : 'å…è´¹ç”¨æˆ·'}}
        </view>
        <view class="membership-desc" wx:if="{{membershipStatus.isPremium}}">
          åˆ°æœŸæ—¶é—´ï¼š{{expireTimeText}}
        </view>
        <view class="membership-desc" wx:else>
          {{freeLimitDesc || 'å…è´¹ç‰ˆå­˜åœ¨åŠŸèƒ½é™åˆ¶ï¼Œå‡çº§è§£é”å…¨éƒ¨åŠŸèƒ½'}}
        </view>
      </view>
    </view>
  </view>

  <!-- ä¼šå‘˜ç‰¹æƒå¯¹æ¯” -->
  <view class="privilege-section">
    <view class="section-title">ğŸŒŸ ä¼šå‘˜ç‰¹æƒå¯¹æ¯”</view>
    
    <view class="privilege-table">
      <view class="privilege-header">
        <view class="privilege-item-name">åŠŸèƒ½ç‰¹æƒ</view>
        <view class="privilege-free">å…è´¹ç‰ˆ</view>
        <view class="privilege-premium">é«˜çº§ä¼šå‘˜</view>
      </view>
      
      <view class="privilege-row" wx:for="{{privilegeList}}" wx:key="name">
        <view class="privilege-item-name">{{item.name}}</view>
        <view class="privilege-free">
          <view class="privilege-value {{item.freeStatus ? 'enabled' : 'disabled'}}">
            {{item.free}}
          </view>
        </view>
        <view class="privilege-premium">
          <view class="privilege-value enabled">{{item.premium}}</view>
        </view>
      </view>
    </view>
  </view>

    <!-- ä»·æ ¼å’Œæ”¯ä»˜é€‰é¡¹åŒºåŸŸ -->
    <view class="price-section" wx:if="{{!membershipStatus.isPremium}}">
      <view class="section-title">ğŸ’ ä¼šå‘˜ä»·æ ¼</view>
      
      <view class="price-card">
        <view class="price-info">
          <view class="price-label">æ°¸ä¹…ä¼šå‘˜</view>
          <view class="price-display">
            <view class="price-original" wx:if="{{discountAmount > 0}}">
              Â¥{{basePrice}}
            </view>
            <view class="price-final">Â¥{{finalPrice}}</view>
          </view>
          <view class="price-desc">è§£é”å…¨éƒ¨åŠŸèƒ½</view>
        </view>
      </view>

      <!-- æ”¯ä»˜æ–¹å¼é€‰æ‹© -->
      <view class="payment-options">
  
        <view class="option-btn {{selectedPaymentType === 'wechat' ? 'active' : ''}}" 
              bindtap="selectPaymentType" 
              data-type="wechat">
          <view class="option-icon">ğŸ’š</view>
          <view class="option-content">
            <view class="option-title">å¾®ä¿¡æ”¯ä»˜</view>
            <view class="option-desc">å®‰å…¨ä¾¿æ·ï¼Œç«‹å³å¼€é€š</view>
          </view>
        </view>
      </view>

    

      <!-- ä¼˜æƒ ç è¾“å…¥ï¼ˆä»…åœ¨é€‰æ‹©å¾®ä¿¡æ”¯ä»˜æ—¶æ˜¾ç¤ºï¼‰ -->
      <view class="discount-section" wx:if="{{selectedPaymentType === 'wechat'}}">
        <view class="discount-label">ä¼˜æƒ ç ï¼ˆå¯é€‰ï¼‰</view>
        <view class="discount-input-wrapper">
          <input 
            class="discount-input {{discountCodeValid ? 'valid' : ''}} {{discountCodeError ? 'error' : ''}}"
            type="text"
            placeholder="è¯·è¾“å…¥ä¼˜æƒ ç "
            value="{{discountCode}}"
            bindinput="onDiscountCodeInput"
            maxlength="20"
          />
          <button 
            class="discount-btn"
            bindtap="validateDiscountCode"
            disabled="{{!discountCode}}">
            éªŒè¯
          </button>
        </view>
        <view class="discount-message">
          <text wx:if="{{discountCodeValid}}" class="discount-success">
            ä¼˜æƒ ç å·²åº”ç”¨ï¼Œå·²ä¼˜æƒ Â¥{{discountAmount}}
          </text>
          <text wx:if="{{discountCodeError && !discountCodeValid}}" class="discount-error">
            {{discountCodeError}}
          </text>
        </view>
      </view>
    </view>

  <!-- æ”¯ä»˜æŒ‰é’®ï¼ˆä»…åœ¨é€‰æ‹©å¾®ä¿¡æ”¯ä»˜æ—¶æ˜¾ç¤ºï¼‰ -->
  <view class="payment-section" wx:if="{{!membershipStatus.isPremium && selectedPaymentType === 'wechat'}}">
    <view class="payment-summary">
      <view class="summary-text">æ°¸ä¹…ä¼šå‘˜</view>
      <view class="summary-price-wrapper">
        <text wx:if="{{discountAmount > 0}}" class="summary-original-price">Â¥{{basePrice}}</text>
        <text class="summary-price">Â¥{{finalPrice}}</text>
      </view>
    </view>
    
    <button class="pay-btn" 
            bindtap="startPayment" 
            disabled="{{paymentLoading}}">
      <view wx:if="{{paymentLoading}}" class="loading-text">
        <view class="loading-icon">â³</view>
        æ”¯ä»˜ä¸­...
      </view>
      <view wx:else>
        <view class="pay-btn-main">
          <text class="pay-btn-icon">ğŸ’š</text>
          <text class="pay-btn-text">å¾®ä¿¡æ”¯ä»˜ Â¥{{finalPrice}}</text>
        </view>
        <view class="pay-btn-subtitle">å¾®ä¿¡å®‰å…¨æ”¯ä»˜</view>
      </view>
    </button>
    
    <view class="payment-tips">
      <view class="tip-item">â€¢ æ”¯ä»˜æˆåŠŸåç«‹å³ç”Ÿæ•ˆ</view>
      <view class="tip-item">â€¢ æ”¯æŒå¾®ä¿¡å®‰å…¨æ”¯ä»˜</view>
      <view class="tip-item">â€¢ è´­ä¹°åå¯åœ¨ä¸ªäººä¸­å¿ƒæŸ¥çœ‹</view>
    </view>
  </view>

  <!-- å·²æ˜¯ä¼šå‘˜çš„ç»­è´¹åŒºåŸŸ -->
  <view class="renewal-section" wx:if="{{membershipStatus.isPremium}}">
    <view class="renewal-info">
      <view class="renewal-title">âœ¨ ç»­è´¹ä¼šå‘˜</view>
      <view class="renewal-desc">ç»§ç»­äº«å—é«˜çº§ä¼šå‘˜ç‰¹æƒ</view>
    </view>
    
    <button class="renewal-btn" bindtap="showRenewalOptions">
      ç»­è´¹ä¼šå‘˜
    </button>
  </view>

  <!-- ç”¨æˆ·ä½¿ç”¨ç»Ÿè®¡ -->
  <view class="stats-section">
    <view class="section-title">ğŸ“Š ä½¿ç”¨ç»Ÿè®¡</view>
    
    <view class="stats-grid">
      <view class="stats-item">
        <view class="stats-number">{{userStats.totalTestCount}}</view>
        <view class="stats-label">ç´¯è®¡æµ‹è¯•</view>
      </view>
      <view class="stats-item">
        <view class="stats-number">{{userStats.dailyUsage.testCount}}</view>
        <view class="stats-label">ä»Šæ—¥æµ‹è¯•</view>
      </view>
      <view class="stats-item">
        <view class="stats-number">{{remainingTests.unlimited ? 'âˆ' : remainingTests.count}}</view>
        <view class="stats-label">å‰©ä½™æ¬¡æ•°</view>
      </view>
    </view>
  </view>

  <!-- å¸¸è§é—®é¢˜ -->
  <view class="faq-section">
    <view class="section-title">â“ å¸¸è§é—®é¢˜</view>
    
    <view class="faq-list">
      <view class="faq-item" wx:for="{{faqList}}" wx:key="question" bindtap="toggleFaq" data-index="{{index}}">
        <view class="faq-question">
          <view class="faq-text">{{item.question}}</view>
          <view class="faq-arrow {{item.expanded ? 'expanded' : ''}}">â–¼</view>
        </view>
        <view class="faq-answer {{item.expanded ? 'show' : ''}}" style="{{item.expanded ? 'max-height: 200px' : ''}}">
          {{item.answer}}
        </view>
      </view>
    </view>
  </view>
</view>
