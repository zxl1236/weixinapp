<!-- æ•°æ®åŒæ­¥æµ‹è¯•é¡µé¢ -->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header">
    <text class="title">ğŸ§ª æ•°æ®åŒæ­¥æµ‹è¯•</text>
    <text class="subtitle">éªŒè¯å››é˜¶æ®µå­¦ä¹ æ•°æ®åŒæ­¥åŠŸèƒ½</text>
  </view>

  <!-- å½“å‰ç»Ÿè®¡ -->
  <view class="stats-section" wx:if="{{currentStats}}">
    <view class="section-title">ğŸ“Š å½“å‰æ•°æ®ç»Ÿè®¡</view>
    
    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-label">å•è¯æŒæ¡æ•°æ®</text>
        <text class="stat-value">{{currentStats.masteryMapSize}}</text>
      </view>
      
      <view class="stat-item">
        <text class="stat-label">å­¦ä¹ ä¼šè¯</text>
        <text class="stat-value">{{currentStats.sessionHistorySize}}</text>
      </view>
      
      <view class="stat-item">
        <text class="stat-label">æ—¥å¸¸ç»Ÿè®¡</text>
        <text class="stat-value">{{currentStats.dailyStatsSize}}</text>
      </view>
    </view>

    <!-- å¹´çº§è¿›åº¦ -->
    <view class="grade-progress">
      <view class="grade-item">
        <text class="grade-name">ä¸‰å¹´çº§</text>
        <text class="grade-stats">
          æ€»è¯æ±‡: {{currentStats.grade3Progress.total}}, 
          æŒæ¡: {{currentStats.grade3Progress.mastered + currentStats.grade3Progress.expert}},
          éœ€è¦å¤ä¹ : {{currentStats.grade3Progress.needReview}}
        </text>
      </view>
      
      <view class="grade-item">
        <text class="grade-name">å››å¹´çº§</text>
        <text class="grade-stats">
          æ€»è¯æ±‡: {{currentStats.grade4Progress.total}}, 
          æŒæ¡: {{currentStats.grade4Progress.mastered + currentStats.grade4Progress.expert}},
          éœ€è¦å¤ä¹ : {{currentStats.grade4Progress.needReview}}
        </text>
      </view>
    </view>
  </view>

  <!-- æµ‹è¯•æ§åˆ¶ -->
  <view class="test-section">
    <view class="section-title">ğŸ§ª æµ‹è¯•æ§åˆ¶</view>
    
    <view class="button-group">
      <button 
        class="test-btn primary" 
        bindtap="runTest" 
        disabled="{{testing}}">
        {{testing ? 'æµ‹è¯•ä¸­...' : 'è¿è¡Œæµ‹è¯•'}}
      </button>
      
      <button 
        class="test-btn secondary" 
        bindtap="quickVerifySync">
        å¿«é€ŸéªŒè¯åŒæ­¥
      </button>
      
      <button 
        class="test-btn danger" 
        bindtap="clearTestData">
        æ¸…ç†æµ‹è¯•æ•°æ®
      </button>
    </view>
  </view>

  <!-- æµ‹è¯•ç»“æœ -->
  <view class="results-section" wx:if="{{testResults}}">
    <view class="section-title">ğŸ“‹ æµ‹è¯•ç»“æœ</view>
    
    <view class="result-summary">
      <view class="summary-item success">
        <text class="summary-label">é€šè¿‡</text>
        <text class="summary-value">{{testResults.summary.passed}}</text>
      </view>
      
      <view class="summary-item fail">
        <text class="summary-label">å¤±è´¥</text>
        <text class="summary-value">{{testResults.summary.failed}}</text>
      </view>
      
      <view class="summary-item total">
        <text class="summary-label">æ€»è®¡</text>
        <text class="summary-value">{{testResults.summary.total}}</text>
      </view>
      
      <view class="summary-item rate">
        <text class="summary-label">æˆåŠŸç‡</text>
        <text class="summary-value">{{testResults.summary.successRate}}%</text>
      </view>
    </view>

    <view class="result-actions">
      <button class="action-btn" bindtap="showTestDetails">æŸ¥çœ‹è¯¦æƒ…</button>
      <button class="action-btn" bindtap="exportReport">å¯¼å‡ºæŠ¥å‘Š</button>
    </view>
  </view>

  <!-- æµ‹è¯•é¡¹ç›®åˆ—è¡¨ -->
  <view class="test-list" wx:if="{{testResults && testResults.details}}">
    <view class="section-title">ğŸ“ æµ‹è¯•é¡¹ç›®</view>
    
    <view 
      class="test-item {{item.passed ? 'passed' : 'failed'}}"
      wx:for="{{testResults.details}}" 
      wx:key="name">
      <view class="test-status">
        <text class="status-icon">{{item.passed ? 'âœ…' : 'âŒ'}}</text>
      </view>
      <view class="test-content">
        <text class="test-name">{{item.name}}</text>
        <text class="test-message">{{item.message}}</text>
      </view>
    </view>
  </view>

  <!-- å­˜å‚¨ä¿¡æ¯ -->
  <view class="storage-section" wx:if="{{currentStats && currentStats.storageInfo}}">
    <view class="section-title">ğŸ’¾ å­˜å‚¨ä¿¡æ¯</view>
    
    <view class="storage-info">
      <text class="storage-text">
        ä½¿ç”¨ç©ºé—´: {{currentStats.storageInfo.currentSize}}KB / {{currentStats.storageInfo.limitSize}}KB
      </text>
      <text class="storage-text">
        ç›¸å…³å­˜å‚¨é”®: {{currentStats.storageInfo.keys.length}} ä¸ª
      </text>
    </view>
  </view>
</view>
