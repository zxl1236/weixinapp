<!--å­¦ä¹ è¿›åº¦é¡µé¢-->
<view class="container">
  <!-- ç²¾ç®€å¤´éƒ¨ -->
  <view class="header">
    <button class="back-btn" bindtap="goBack">â† è¿”å›</button>
    <view class="title">{{gradeName}}å­¦ä¹ è¿›åº¦</view>
  </view>

  <!-- æ ¸å¿ƒæ•°æ®å±•ç¤º -->
  <view class="core-stats">
    <view class="mastery-display">
      <!-- ç¯å½¢è¿›åº¦å›¾ -->
      <view class="ring-chart">
        <view class="ring-container">
          <view class="ring-progress" style="--progress: {{stats.masteryRate}}%;"></view>
          <view class="ring-center">
            <view class="mastery-percent">{{stats.masteryRate}}%</view>
            <view class="mastery-label">æŒæ¡ç‡</view>
          </view>
        </view>
      </view>
      
      <!-- ç»Ÿè®¡ä¿¡æ¯ -->
      <view class="stats-info">
        <view class="total-words">å…±{{stats.totalWords}}ä¸ªè¯æ±‡</view>
        <view class="mastered-count">å·²æŒæ¡{{stats.masteredCount}}ä¸ª</view>
      </view>
    </view>
  </view>

  <!-- è¯¦ç»†ç»Ÿè®¡ -->
  <view class="detailed-stats">
    <view class="stats-title">å­¦ä¹ çŠ¶æ€åˆ†å¸ƒ</view>
    
    <view class="stat-item mastered-item" bindtap="showWordList" data-type="mastered">
      <view class="stat-left">
        <view class="stat-dot mastered-dot"></view>
        <view class="stat-text">
          <view class="stat-name">å·²æŒæ¡</view>
          <view class="stat-desc">å®Œå…¨æŒæ¡çš„å•è¯</view>
        </view>
      </view>
      <view class="stat-right">
        <view class="stat-count">{{stats.masteredCount}}</view>
        <view class="stat-arrow">â†’</view>
      </view>
    </view>

    <view class="stat-item error-item" bindtap="showWordList" data-type="withErrors" wx:if="{{stats.withErrorsCount > 0}}">
      <view class="stat-left">
        <view class="stat-dot error-dot"></view>
        <view class="stat-text">
          <view class="stat-name">éœ€å¤ä¹ </view>
          <view class="stat-desc">ç­”é”™è¿‡çš„å•è¯</view>
        </view>
      </view>
      <view class="stat-right">
        <view class="stat-count">{{stats.withErrorsCount}}</view>
        <view class="stat-arrow">â†’</view>
      </view>
    </view>

    <view class="stat-item learning-item" bindtap="showWordList" data-type="learning" wx:if="{{stats.learningCount > 0}}">
      <view class="stat-left">
        <view class="stat-dot learning-dot"></view>
        <view class="stat-text">
          <view class="stat-name">å­¦ä¹ ä¸­</view>
          <view class="stat-desc">æ­£åœ¨å­¦ä¹ çš„å•è¯</view>
        </view>
      </view>
      <view class="stat-right">
        <view class="stat-count">{{stats.learningCount}}</view>
        <view class="stat-arrow">â†’</view>
      </view>
    </view>

    <view class="stat-item unlearned-item" bindtap="showWordList" data-type="unlearned">
      <view class="stat-left">
        <view class="stat-dot unlearned-dot"></view>
        <view class="stat-text">
          <view class="stat-name">æœªå­¦ä¹ </view>
          <view class="stat-desc">å°šæœªå¼€å§‹å­¦ä¹ </view>
        </view>
      </view>
      <view class="stat-right">
        <view class="stat-count">{{stats.unlearnedCount}}</view>
        <view class="stat-arrow">â†’</view>
      </view>
    </view>
  </view>

  <!-- å•è¯åˆ—è¡¨å¼¹çª— -->
  <view class="word-list-modal" wx:if="{{showWordList}}" bindtap="hideWordList">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <view class="modal-title">{{currentListTitle}}</view>
        <button class="close-btn" bindtap="hideWordList">Ã—</button>
      </view>
      
      <view class="modal-body">
        <view class="word-count-info">å…± {{currentWordList.length}} ä¸ªå•è¯</view>
        
        <view class="word-list" wx:if="{{currentWordList.length > 0}}">
          <view class="word-item" wx:for="{{currentWordList}}" wx:key="word">
            <view class="word-main">
              <view class="word-english">{{item.word}}</view>
              <view class="word-phonetic" wx:if="{{item.phonetic}}">{{item.phonetic}}</view>
            </view>
            <view class="word-chinese">{{item.chinese}}</view>
            <view class="word-status {{item.status}}">
              <text wx:if="{{item.status === 'mastered'}}">âœ…</text>
              <text wx:elif="{{item.status === 'withErrors'}}">âš ï¸</text>
              <text wx:elif="{{item.status === 'learning'}}">ğŸ“–</text>
              <text wx:else="">â­•</text>
            </view>
          </view>
        </view>
        
        <view class="empty-list" wx:else="">
          <view class="empty-icon">ğŸ“­</view>
          <view class="empty-text">æš‚æ— ç›¸å…³å•è¯</view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç²¾ç®€æ“ä½œ -->
  <view class="main-actions">
    <button class="main-action-btn learn-btn" bindtap="startLearning" wx:if="{{stats.unlearnedCount > 0}}">
      å¼€å§‹å­¦ä¹ 
    </button>
    <button class="main-action-btn review-btn" bindtap="reviewErrors" wx:if="{{stats.withErrorsCount > 0}}">
      å¤ä¹ é”™è¯
    </button>
  </view>
</view>
