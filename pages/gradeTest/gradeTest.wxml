<!--æ°´å¹³æµ‹è¯•é¡µé¢-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header">
    <view class="page-title">ğŸ“Š æ°´å¹³æµ‹è¯•</view>
    <view class="page-subtitle">è¯„ä¼°å„å¹´çº§è¯æ±‡æŒæ¡æ°´å¹³</view>
  </view>

  <!-- æ¨¡å¼è¯´æ˜ -->
  <view class="mode-explanation">
    <view class="mode-title">ğŸ¯ æµ‹è¯•è¯´æ˜</view>
    <view class="mode-desc">é€šè¿‡å°‘é‡é¢˜ç›®å¿«é€Ÿè¯„ä¼°å„å¹´çº§æŒæ¡æƒ…å†µï¼Œå»ºè®®æŒ‰é¡ºåºæµ‹è¯•</view>
  </view>

  <!-- é˜¶æ®µé€‰æ‹© -->
  <view class="stage-selection" wx:if="{{!showGradeList}}">
    <view class="stage-list">
      <view 
        class="stage-card" 
        wx:for="{{stages}}" 
        wx:key="id"
        bindtap="selectStage"
        data-stage="{{item.id}}"
      >
        <view class="stage-icon">{{item.icon}}</view>
        <view class="stage-info">
          <view class="stage-name">{{item.name}}</view>
          <view class="stage-desc">{{item.description}}</view>
          <view class="stage-count">å…±{{item.grades.length}}ä¸ªå¹´çº§</view>
        </view>
        <view class="stage-arrow">â¤</view>
      </view>
    </view>
  </view>

  <!-- å¹´çº§é€‰æ‹©è§†å›¾ -->
  <view class="grade-selection" wx:if="{{showGradeList && selectedStageData}}">
    <!-- è¿”å›æŒ‰é’® -->
    <view class="back-header">
      <button class="back-btn" bindtap="backToStages">
        â† è¿”å›é˜¶æ®µé€‰æ‹©
      </button>
    </view>

    <!-- å½“å‰é˜¶æ®µä¿¡æ¯ -->
    <view class="current-stage-info">
      <view class="stage-badge">
        <text class="stage-icon-small">{{selectedStageData.icon}}</text>
        <text class="stage-name-small">{{selectedStageData.name}}</text>
      </view>
      <view class="stage-desc-small">{{selectedStageData.description}}</view>
    </view>

    <!-- å¹´çº§åˆ—è¡¨ -->
    <view class="grade-list">
      <view 
        class="grade-card" 
        wx:for="{{selectedStageData.grades}}" 
        wx:key="id"
      >
        <view class="grade-info">
          <view class="grade-name">{{item.name}}</view>
          <view class="grade-stats">
            <text class="word-count">è¯æ±‡é‡: {{item.totalWords || 96}}</text>
            <view class="mastery-info">
              <text class="mastery-rate">æŒæ¡ç‡: {{item.mastery || 0}}%</text>
            </view>
          </view>
        </view>
        
        <view class="grade-actions">
          <button 
            class="test-btn" 
            bindtap="startGradeTest"
            data-grade="{{item.id}}"
          >
            æ°´å¹³æµ‹è¯•
          </button>
          <button 
            class="train-btn" 
            bindtap="startGradeTraining"
            data-grade="{{item.id}}"
          >
            å¼€å§‹è®­ç»ƒ
          </button>
          <button 
            class="progress-btn" 
            bindtap="toggleProgress"
            data-grade="{{item.id}}"
          >
            æŸ¥çœ‹è¿›åº¦
          </button>
        </view>
        
        <!-- å±•å¼€çš„è¿›åº¦è¯¦æƒ… -->
        <view class="progress-detail" wx:if="{{expandedGrade === item.id}}">
          <view class="progress-item mastered">
            <text class="progress-label">å·²æŒæ¡:</text>
            <text class="progress-value">{{item.mastered || 0}}</text>
          </view>
          <view class="progress-item incorrect">
            <text class="progress-label">ç­”é”™:</text>
            <text class="progress-value">{{item.incorrect || 2}}</text>
          </view>
          <view class="progress-item unlearned">
            <text class="progress-label">æœªå­¦ä¹ :</text>
            <text class="progress-value">{{item.unlearned || 94}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æç¤º -->
  <view class="footer-tips" wx:if="{{!showGradeList}}">
    <view class="tip-item">
      ğŸ’¡ é€‰æ‹©å­¦ä¹ é˜¶æ®µå¼€å§‹æµ‹è¯•
    </view>
    <view class="tip-item">
      ğŸ“ˆ å»ºè®®æŒ‰é¡ºåºæµ‹è¯•ï¼Œäº†è§£å„å¹´çº§æŒæ¡æƒ…å†µ
    </view>
  </view>

  <!-- è¿”å›æŒ‰é’® -->
  <view class="back-btn" bindtap="goHome">
    â† è¿”å›é¦–é¡µ
  </view>
</view>