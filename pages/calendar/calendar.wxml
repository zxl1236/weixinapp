<!--å­¦ä¹ æ—¥å†é¡µé¢-->
<!-- æ–°å¢ calendar-page æ–¹ä¾¿ä½œç”¨åŸŸç®¡ç† -->
<view class="container calendar-page">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header glass-header">
    <text class="title">å­¦ä¹ æ—¥å†</text>
    <!-- å¯é€‰å‰¯æ ‡é¢˜ -->
    <!-- <text class="subtitle">åšæŒä¸€ç‚¹ç‚¹ï¼Œæ¯å¤©éƒ½çœ‹å¾—è§</text> -->
  </view>

  <!-- å­¦ä¹ æ€»æ•°æ® -->
  <view class="stats-card glass-card">
    <text class="stats-title">å­¦ä¹ æ€»æ•°æ®</text>
    <view class="stats-row">
      <view class="stat-item">
        <view class="stat-number-group">
          <text class="stat-number">{{studyStats.totalWords}}</text>
          <text class="stat-unit">ä¸ª</text>
        </view>
        <text class="stat-label">å…±å­¦ä¹ </text>
      </view>
      <view class="stat-item">
        <view class="stat-number-group">
          <text class="stat-number">{{studyStats.totalMastered || studyStats.totalMistakes}}</text>
          <text class="stat-unit">ä¸ª</text>
        </view>
        <text class="stat-label">ç´¯è®¡æŒæ¡</text>
      </view>
      <view class="stat-item">
        <view class="stat-number-group">
          <text class="stat-number">{{studyStats.continuousDays}}</text>
          <text class="stat-unit">å¤©</text>
        </view>
        <text class="stat-label">åšæŒå¤©æ•°</text>
      </view>
    </view>
  </view>

  <!-- æ—¥å†ä¸»ä½“ -->
  <view class="calendar-container glass-card">
    <!-- æœˆä»½å¯¼èˆª -->
    <view class="month-nav">
      <view class="nav-btn" bindtap="prevMonth">
        <text class="nav-icon">â€¹</text>
      </view>
      <text class="month-text">{{currentYear}}å¹´{{currentMonth}}æœˆ</text>
      <view class="nav-btn" bindtap="nextMonth">
        <text class="nav-icon">â€º</text>
      </view>
      <!-- ç”¨ button æ”¯æŒ hover-class æŒ‰å‹åŠ¨ç”» -->
      <button class="today-btn btn" hover-class="btn-press" bindtap="goToToday">
        <text class="today-text">å›åˆ°ä»Šå¤©</text>
      </button>
    </view>

    <!-- æ˜ŸæœŸæ ‡é¢˜ -->
    <view class="week-header">
      <text class="week-day">æ—¥</text>
      <text class="week-day">ä¸€</text>
      <text class="week-day">äºŒ</text>
      <text class="week-day">ä¸‰</text>
      <text class="week-day">å››</text>
      <text class="week-day">äº”</text>
      <text class="week-day">å…­</text>
    </view>

    <!-- æ—¥å†ç½‘æ ¼ -->
    <view class="calendar-grid">
      <view 
        wx:for="{{calendarDays}}" 
        wx:key="date"
        class="calendar-day {{item.isCurrentMonth ? '' : 'other-month'}} {{item.isToday ? 'today' : ''}} {{item.hasStudy ? 'has-study' : ''}} intensity-{{item.intensity || 0}}"
        bindtap="onDayTap"
        data-date="{{item.date}}"
      >
        <text class="day-number">{{item.day}}</text>
        <view wx:if="{{item.hasStudy}}" class="study-indicator">
          <text class="study-count">{{item.studyCount || 'å­¦'}}</text>
        </view>
      </view>
    </view>

    <!-- é€‰ä¸­æ—¥æœŸä¿¡æ¯ -->
    <view class="selected-date" wx:if="{{selectedDate}}">
      <text class="selected-date-text">{{selectedDateText}}</text>
    </view>
  </view>

  <!-- å¤ä¹ æé†’å¡ç‰‡ -->
  <view class="review-reminder gradient-pink" wx:if="{{reviewStats.needsReviewCount > 0}}">
    <view class="reminder-content">
      <text class="reminder-title">ğŸ“š å¤ä¹ æé†’</text>
      <text class="reminder-subtitle">æœ‰ {{reviewStats.needsReviewCount}} ä¸ªå•è¯éœ€è¦å¤ä¹ </text>
    </view>
    <button class="reminder-action btn" hover-class="btn-press" bindtap="startReview">
      <text class="action-text">å¼€å§‹å¤ä¹ </text>
    </button>
  </view>

  <!-- å­¦ä¹ è®°å½•å¡ç‰‡ -->
  <view class="study-records">
    <view class="record-item glass-card" bindtap="goToStudyRecord">
      <view class="record-icon gradient-primary">
        <image src="../../images/book-icon.png" class="icon-image" mode="aspectFit"></image>
      </view>
      <view class="record-content">
        <text class="record-title">å­¦ä¹ è®°å½•</text>
        <text class="record-subtitle">å·²å­¦ {{studyStats.totalWords}} ä¸ª</text>
      </view>
      <text class="record-arrow">â€º</text>
    </view>

    <view class="record-item glass-card" bindtap="goToReviewRecord">
      <view class="record-icon gradient-primary">
        <image src="../../images/review-icon.png" class="icon-image" mode="aspectFit"></image>
      </view>
      <view class="record-content">
        <text class="record-title">é”™é¢˜å¤ä¹ </text>
        <text class="record-subtitle">{{reviewStats.mistakeCount}} ä¸ªé”™é¢˜å¾…å¤ä¹ </text>
      </view>
      <text class="record-arrow">â€º</text>
    </view>

    <view class="record-item glass-card" bindtap="goToWeakWords">
      <view class="record-icon gradient-primary">
        <image src="../../images/mistake.png" class="icon-image" mode="aspectFit"></image>
      </view>
      <view class="record-content">
        <text class="record-title">è–„å¼±è¯æ±‡</text>
        <text class="record-subtitle">{{reviewStats.weakWordsCount}} ä¸ªè–„å¼±è¯æ±‡</text>
      </view>
      <text class="record-arrow">â€º</text>
    </view>
  </view>
</view>